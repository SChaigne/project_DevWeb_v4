{% extends 'base.html.twig' %}

{% block title %}CG - Accueil{% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
    a {
      color: black;
    }
</style>

<div class="example-wrapper">
    <h1>GroovyCrypto {{ controller_name }}</h1>
<a href="{{ path('maj_crypto_API') }}">Maj Data Crypto with API</a>

   <table class="table table-hover">
  <thead>
    <tr>

      <th scope="col">Nom</th>
      <th scope="col">Symbole</th>
      <th scope="col">Price</th>
      <th scope="col">Market Cap</th>
      <th scope="col"></th>
    </tr>
  </thead>
  <tbody>
    {% for crypto in cryptos %}
    <tr class="table-primary">
    
      {# <th scope="row">{{crypto.id}}</th>
      <td>{{crypto.name}}</td>
      <td>{{crypto.symbol}}</td>
      <td>{{crypto.price}}</td>
      <td>{{crypto.marketcap}}</td> #}

      <th scope="row"><a href="{{ path('app_details_crypto', {'id': crypto.id}) }}">{{crypto.name}}</a></th>
      <td><a href="{{ path('app_details_crypto', {'id': crypto.id}) }}">{{crypto.symbol}}</a></td>
      <td><a href="{{ path('app_details_crypto', {'id': crypto.id}) }}">{{crypto.price}}</a></td>
      <td><a href="{{ path('app_details_crypto', {'id': crypto.id}) }}">{{crypto.marketcap}}</a></td>
      
      {% set subId = 0 %}
      {% if user %}
        {% set abo = false %}
        {% for sub in crypto.subscribes %}
          {% for unUser in sub.idUser %}
            {% if user == unUser %}
              {% set abo = true %}
              {% set subId = sub.id %}
            {% endif %}
          {% endfor %}
        {% endfor %}
        {% if abo %}
          {#<td><button><a href="{{path('app_subscribe_delete', {'id': subId})}}">Se d√©sabonner</a></button></td>#}
          <td>{{ include('subscribe/_delete_form.html.twig') }}</td>
        {% else %}
          <td><button><a href="{{path('app_subscribe_new', {'id_crypto': crypto.id})}}">S'abonner</a></button></td>
        {% endif %}
      {% else %}
        <td><button><a href="{{path('app_subscribe_new', {'id_crypto': crypto.id})}}">S'abonner</a></button></td>
      {% endif %}
    </tr>
    {% endfor %}
  </tbody>
</table>
</div>
{% endblock %}
